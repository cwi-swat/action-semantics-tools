<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Store.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="packages.html">Packages</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>Store.java</h1><a href="Store_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 package ajc;
00002 
00003 import java.util.<a class="code" href="classHashtable.html">Hashtable</a>;
00004 import ajc.data.*;
00005 
00006 <font class="comment">/* Singleton pattern. */</font>
<a name="l00007"></a><a class="code" href="classStore.html">00007</a> <font class="keyword">public</font> <font class="keyword">class </font><a class="code" href="classStore.html">Store</a> implements <a class="code" href="interfaceStoring.html">Storing</a> {
<a name="l00008"></a><a class="code" href="classStore.html#r0">00008</a>     <font class="keyword">private</font> <font class="keyword">static</font> <a class="code" href="classStore.html">Store</a> theStore = null;
00009 
<a name="l00010"></a><a class="code" href="classStore.html#o0">00010</a>     <font class="keyword">private</font> <a class="code" href="interfaceDataFactory.html">DataFactory</a> factory;
<a name="l00011"></a><a class="code" href="classStore.html#o1">00011</a>     <font class="keyword">private</font> <a class="code" href="classHashtable.html">Hashtable</a> table;
00012 
<a name="l00013"></a><a class="code" href="classStore.html#c0">00013</a>     <font class="keyword">private</font> Store(<a class="code" href="interfaceDataFactory.html">DataFactory</a> factory, <font class="keywordtype">int</font> cap, <font class="keywordtype">int</font> loadf)<font class="keyword"> </font>{
00014         <font class="keyword">this</font>.factory = factory;
00015         table = <font class="keyword">new</font> Hashtable(cap, loadf);
00016     }
00017     
<a name="l00018"></a><a class="code" href="classStore.html#d0">00018</a>     <font class="keyword">public</font> <font class="keyword">static</font> <font class="keywordtype">void</font> initStore(<a class="code" href="interfaceDataFactory.html">DataFactory</a> factory)<font class="keyword"> </font>{
00019         initStore(factory, 1024);
00020     }
00021 
<a name="l00022"></a><a class="code" href="classStore.html#d1">00022</a>     <font class="keyword">public</font> <font class="keyword">static</font> <font class="keywordtype">void</font> initStore(<a class="code" href="interfaceDataFactory.html">DataFactory</a> factory, <font class="keywordtype">int</font> cap)<font class="keyword"> </font>{
00023         initStore(factory, cap, 75);
00024     }
00025 
<a name="l00026"></a><a class="code" href="classStore.html#d2">00026</a>     <font class="keyword">public</font> <font class="keyword">static</font> <font class="keywordtype">void</font> initStore(<a class="code" href="interfaceDataFactory.html">DataFactory</a> factory, <font class="keywordtype">int</font> cap, <font class="keywordtype">int</font> loadf)<font class="keyword"> </font>{
00027         theStore = <font class="keyword">new</font> Store(factory, cap, loadf);
00028     }
00029 
<a name="l00030"></a><a class="code" href="classStore.html#d3">00030</a>     <font class="keyword">public</font> <font class="keyword">static</font> <a class="code" href="classStore.html">Store</a> getStore()<font class="keyword"> </font>{
00031         <font class="keywordflow">if</font> (theStore == null)
00032             <font class="keywordflow">throw</font> <font class="keyword">new</font> RuntimeException(<font class="stringliteral">"Initialize store first!"</font>);
00033         <font class="keywordflow">return</font> theStore;
00034     }
00035 
00036     <font class="comment">/* Interface */</font>
<a name="l00037"></a><a class="code" href="classStore.html#a0">00037</a>     <font class="keyword">public</font> synchronized <a class="code" href="interfaceCell.html">Cell</a> <a class="code" href="interfaceStoring.html#a0">create</a>(<a class="code" href="interfaceStorable.html">Storable</a> o)<font class="keyword"> </font>{
00038         <a class="code" href="interfaceCell.html">Cell</a> cell = factory.<a class="code" href="interfaceDataFactory.html#a11">makeCell</a>();
00039         table.put(cell, o);
00040         <font class="keywordflow">return</font> cell;    
00041     }
00042 
<a name="l00043"></a><a class="code" href="classStore.html#a1">00043</a>     <font class="keyword">public</font> synchronized <a class="code" href="interfaceEmpty.html">Empty</a> <a class="code" href="interfaceStoring.html#a1">destroy</a>(<a class="code" href="interfaceCell.html">Cell</a> cell) throws <a class="code" href="classExceptional.html">Exceptional</a> {
00044         <font class="keywordflow">if</font> (table.remove(cell) == null)
00045             <font class="keywordflow">throw</font> <font class="keyword">new</font> Exceptional(<font class="stringliteral">"destroy: cell non-existent"</font>, factory.<a class="code" href="interfaceDataFactory.html#a0">makeEmpty</a>());
00046         <font class="keywordflow">return</font> factory.<a class="code" href="interfaceDataFactory.html#a0">makeEmpty</a>();
00047     }
00048 
<a name="l00049"></a><a class="code" href="classStore.html#a2">00049</a>     <font class="keyword">public</font> synchronized <a class="code" href="interfaceEmpty.html">Empty</a> <a class="code" href="interfaceStoring.html#a2">update</a>(<a class="code" href="interfaceCell.html">Cell</a> cell, <a class="code" href="interfaceStorable.html">Storable</a> o) throws <a class="code" href="classExceptional.html">Exceptional</a> {
00050         <font class="keywordflow">if</font> (!table.containsKey(cell)) 
00051             <font class="keywordflow">throw</font> <font class="keyword">new</font> Exceptional(<font class="stringliteral">"update: cell non-existent"</font>, factory.<a class="code" href="interfaceDataFactory.html#a0">makeEmpty</a>());
00052         table.put(cell, o);
00053         <font class="keywordflow">return</font> factory.<a class="code" href="interfaceDataFactory.html#a0">makeEmpty</a>();
00054     }
00055 
<a name="l00056"></a><a class="code" href="classStore.html#a3">00056</a>     <font class="keyword">public</font> synchronized <a class="code" href="interfaceStorable.html">Storable</a> <a class="code" href="interfaceStoring.html#a3">inspect</a>(<a class="code" href="interfaceCell.html">Cell</a> cell) throws <a class="code" href="classExceptional.html">Exceptional</a> {
00057         <font class="keywordflow">if</font> (!table.containsKey(cell)) 
00058             <font class="keywordflow">throw</font> <font class="keyword">new</font> Exceptional(<font class="stringliteral">"inpect: cell non-existent"</font>, factory.<a class="code" href="interfaceDataFactory.html#a0">makeEmpty</a>());
00059         <font class="keywordflow">return</font> (<a class="code" href="interfaceStorable.html">Storable</a>)(table.get(cell));
00060     }
00061 
<a name="l00062"></a><a class="code" href="classStore.html#a4">00062</a>     <font class="keyword">public</font> String toString()<font class="keyword"> </font>{
00063         <font class="keywordflow">return</font> table.toString();
00064     }
00065 
00066 }
00067     
</pre></div><hr><address><small>Generated at Thu Sep 12 20:07:45 2002 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
